<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Anatomy of a Simulation</title>
<link href="stylesheet.css" rel="stylesheet" type="text/css">
<!--<link href="tabs.css" rel="stylesheet" type="text/css"> -->
<!-- <script src="../mathjax/MathJax.js">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script> -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-22953817-1']);
  _gaq.push(['_trackPageview']);
  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<script type="text/javascript">
function toggleMenu(objID, button) {
    if (!document.getElementById) return;
    var ob = document.getElementById(objID).style;
    if(ob.display == 'block') {
	ob.display = 'none';
	button.innerHTML = "+";
    }
    else {
	ob.display = 'block';
	button.innerHTML = "-";
    }
    //ob.display = (ob.display == 'block')?'none': 'block';
}
</script>
</head><body>
<a name="top"></a>
<!-- wrap starts here -->
<div id="nottrac">
<div id="wrap">
	<a name="top"></a>
	<!-- header -->
	<div id="topheader">
		<div id="logo"><img src="logo.jpg" alt="pyVAFM" /></div>
		<!-- tabs 
		<ul>
			<li><a href="../index.html"><span>Home</span></a></li>
			<li><a href="./credits.html"><span>About</span></a></li>
			<li id="current"><a href="./index.html"><span>Documentation</span></a></li>
			<li><a href="../download.html"><span>Download</span></a></li>
			<li><a href="../contact.html"><span>Contact</span></a></li>
		</ul>
		-->
	</div>
	<div id="header-slogan">
	<span id="slogan">Pythonic Virtual Machine</span>
	</div>
	<div id="maincol">
    <div id="top"><!-- do not remove this div! -->
<!-- Generated by Doxygen 1.8.9.1 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Anatomy of a Simulation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Anatomy of a Simulation </h1>
<p>In this section we will describe in very general terms how the PyVAFM will work. Work flow for every PyVAFM simulation will follow more or less the same steps.</p>
<div class="image">
<img src="WorkFlow.png" alt="WorkFlow.png"/>
<div class="caption">
WorkFlow</div></div>
<h2>The Input Script </h2>
<p>Here an example input script is demonstrated;</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">##!/usr/bin/env python</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="keyword">import</span> sys</div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;sys.path.append(<span class="stringliteral">&#39;/Users/johntracey/Desktop/pyvafm-master/src&#39;</span>)</div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="keyword">from</span> vafmbase <span class="keyword">import</span> ChannelType</div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="keyword">from</span> vafmcircuits <span class="keyword">import</span> Machine</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="keyword">import</span> vafmcircuits</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; <span class="comment">#Initalise the PyVAFM Core</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;machine = Machine(name=<span class="stringliteral">&#39;machine&#39;</span>, dt=0.0001, pushed=<span class="keyword">True</span>)</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;machine.AddCircuit(type=<span class="stringliteral">&#39;waver&#39;</span>,name=<span class="stringliteral">&#39;wave&#39;</span>, amp=1, freq=2, phi=1, offset=2.0, pushed=<span class="keyword">True</span>) <span class="comment"># adding a circuit</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;machine.AddCircuit(type=<span class="stringliteral">&#39;square&#39;</span>,name=<span class="stringliteral">&#39;sqw&#39;</span>, amp=1.5, freq=2, offset=0.0, duty=0.2, pushed=<span class="keyword">True</span> ) <span class="comment"># adding another circuit</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;machine.AddCircuit(type=<span class="stringliteral">&#39;opAdd&#39;</span>,name=<span class="stringliteral">&#39;Add&#39;</span>, pushed=<span class="keyword">True</span> )</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;machine.Connect(<span class="stringliteral">&quot;wave.sin&quot;</span>,<span class="stringliteral">&quot;Add.in1&quot;</span>)   <span class="comment">#connect a sin wave to the add circuits input 1</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;machine.Connect(<span class="stringliteral">&quot;wave.sin&quot;</span>,<span class="stringliteral">&quot;Add.in2&quot;</span>)   <span class="comment">#connect a sin wave to the add circuits input 2</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;out1 = machine.AddCircuit(type=<span class="stringliteral">&#39;output&#39;</span>,name=<span class="stringliteral">&#39;output&#39;</span>,file=<span class="stringliteral">&#39;wavers.log&#39;</span>, dump=1)</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;out1.Register(<span class="stringliteral">&#39;global.time&#39;</span>, <span class="stringliteral">&#39;wave.sin&#39;</span>, <span class="stringliteral">&#39;wave.cos&#39;</span>, <span class="stringliteral">&#39;wave.saw&#39;</span>, <span class="stringliteral">&#39;sqw.out&#39;</span>,<span class="stringliteral">&quot;Add.out&quot;</span>)</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;machine.Wait(1) <span class="comment">#telling the simulation to wait for 1 second</span></div>
</div><!-- fragment --><p>It may look a bit of a mess right now but each part does follow a common pattern, I wont go into to much detail here but a general overview of each part of the code will be presented:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;machine = Machine(name=<span class="stringliteral">&#39;machine&#39;</span>, dt=0.0001, pushed=<span class="keyword">True</span>)</div>
</div><!-- fragment --><p>This part of the code is required for all input scripts, it essentially sets up the PyVAFM and should alwyas be included first. As well as setting up the PyVAFM this also lets you define the timestep for the simulation, in this case it is set as dt=0.001, finally you can decide if the machine is pushed or not, again more detail on what pushing in the Circuits User Guide section.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;machine.AddCircuit(type=<span class="stringliteral">&#39;waver&#39;</span>,name=<span class="stringliteral">&#39;wave&#39;</span>, amp=1, freq=2, phi=1, offset=2.0, pushed=<span class="keyword">True</span>)</div>
</div><!-- fragment --><p>This is the command used to add a circuit to the PyVAFM system. The details of the nature of these circuits will be demonstrated in section 4 but for now lets just consider a general form. A circuit is simply a black box that takes input and produces an output. The idea is that these black boxes simulate some process and are then connected together to build the simulation. Circuits are named separately and may have initialisation parameters like this one. this particular circuit outputs waves such as sin, cos etc. So we have assigned the type of circuit as 'waver', the name of the circuit as 'wave' and initialisation parameters amplitude (amp), frequency (freq), phi and offset. This has been a very loose explnation on how the circuits work but this is covered in more detail in the Circuits User Guide section.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;machine.Connect(<span class="stringliteral">&quot;wave.sin&quot;</span>,<span class="stringliteral">&quot;Add.in1&quot;</span>)</div>
</div><!-- fragment --><p>This is how you connect circuits, you must connect the output of one circuit to the input of another for example in this case the circuit named wave with the output sin (wave.sin) is connected to circuit named Add that has the input in1 (Add.in1), Again more details in the Circuits User Guide.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;out1 = machine.AddCircuit(type=<span class="stringliteral">&#39;output&#39;</span>,name=<span class="stringliteral">&#39;output&#39;</span>,file=<span class="stringliteral">&#39;wavers.log&#39;</span>, dump=1)</div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;out1.Register(<span class="stringliteral">&#39;global.time&#39;</span>, <span class="stringliteral">&#39;wave.sin&#39;</span>, <span class="stringliteral">&#39;wave.cos&#39;</span>, <span class="stringliteral">&#39;wave.saw&#39;</span>, <span class="stringliteral">&#39;sqw.out&#39;</span>,<span class="stringliteral">&quot;Add.out&quot;</span>)</div>
</div><!-- fragment --><p>This is the output circuit, it follows the same pattern as the add circuits described before. It contains the type of circuit, the name and two initialisation parameters namely file and dump. More details on the output circuit can be found in section 4.4.1. The 2nd part of this output command is the .Register part. Some circuits require additional inputs for example here this additional input is used to register channel names to be outputted by the output circuit. </p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;machine.Wait(1)</div>
</div><!-- fragment --><p>This command simply tells the simulation to wait for 1 second, the simulation will then run for one second and end during this time the calculation are run for the circuits that have been added. </p>
</div></div><!-- contents -->

<hr size="1"><address style="text-align: right;">
<div class="float-left">Documentation for pyVAFM </div>
<div class="float-right">
<small>
Generated on Fri May 15 2015 16:50:51 for pyVAFM by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.8.9.1</small></address>
</div>
<!-- top ends here -->
<!-- </div> -->
<!-- wrap ends here -->
</div>
<!-- footer starts here -->
<div class="footer">
    <p>
    <a href="./index.html">Home</a><br>
    Copyright &copy; 2013 Regents of Aalto University
    </p>
</div>
</div>
</body>
</html>
